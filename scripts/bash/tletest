<<COMMENT
Details for script lister program:
command     : tletest
description : To be deleted
list        : false
COMMENT
# Shell script to just test whether the my solution runs under 2s using the inputs generated by generator.cpp

set -e
opt_sol=${1:-"opt_sol"}
generator=${3-"generator"}
if [[ $opt_sol == *.cpp ]]
then
    opt_sol=${opt_sol%".cpp"}
fi
if [[ $generator == *.cpp ]]
then
    generator=${generator%".cpp"}
fi
if ! test -f ../${opt_sol}.cpp
then
    echo "${opt_sol}.cpp does not exist"
    exit 1
fi
if ! test -f ${generator}.cpp
then
    echo "${generator}.cpp does not exist"
    exit 1
fi
function handle_ctrlc()
{
    rm -f $generator
    rm -f $opt_sol
    exit
}
# function timed_out()
# {
#     echo "${opt_sol}.cpp timed out"
#     handle_ctrlc
#     exit
# }
trap handle_ctrlc SIGINT
# trap timed_out SIGTERM
echo "Testing ${opt_sol}.cpp with ${generator}.cpp for TLE"
cpr $generator.cpp --compile
cpr ../$opt_sol.cpp --compile
for((i=1;;++i));do
    echo $i
    # Call generator and pipe to input
    ./$generator > input
    timeout 2s bash -c ./$opt_sol < input > out1
done
handle_ctrlc